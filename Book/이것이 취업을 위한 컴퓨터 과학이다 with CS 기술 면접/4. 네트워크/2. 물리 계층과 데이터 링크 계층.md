# 물리 계층과 데이터 링크 계층

## 이더넷

물리 계층과 데이터 링크 게층에는 LAN 내의 호스트들이 올바르게 정보를 주고 받을 수 해주는 다양한 기술들이 포함되어 있습니다. 그 기술의 대표적인 예시가 바로 이더넷입니다. 

이더넷은 통신 매체를 통해 신호를 송수신하는 방법, 데이터 링크 계층에서 주고받는 데이터(프레임) 형식 등이 정의된 기술을 말합니다. 현대 대부분의 (유선)LAN은 이더넷을 기반으로 구현되어 있습니다. 

### 이더넷 표준

이더넷은 IEEE 802.3이라는 이름으로 국제 표준화된 기술입니다. 서로 다른 제조사의 네트워크 장비라 하더라도 LAN 내의 모든 컴퓨터가 해당 네트워크 장비와 문제없이 호환되는 이유는 “”네트워크 장비들이 관련 표준을 준수하여 제작되었기 때문입니다.””

일반적으로 개발자 입장에서 이더넷 표준을 자세히 들여다 봐야할 상황은 많지만 아래 두가지 사항은 기억해둬야합니다. 

- 오늘날의 (유선)LAN 대부분이 이더넷 표준을 따르기 때문에 대다수의 LAN 장비들이 특정 이더넷 표준을 따른다.
- 이더넷 표준이 달라지면 통신 매체의 종류를 비롯한 신호 송수신 방법, 나아가 최대 지원 속도도 달라질 수 있다.

---

## 이더넷 프레임

이더넷 프레임이란 이더넷 기반의 네트워크에서 주고받는 프레임을 말합니다. 오늘날 주로 사용되는 이더넷 프레임은 Ethernet II 프레임이라고도 부릅니다. 오늘날 (유선)LAN은 대부분 이더넷을 기반으로 구현되고 있기 때문에 사실상 ‘프레임’이 이더넷 프레임을 지칭한다고 봐도 무방합니다. 프레임은 다음과 같이 프리앰블, 수신지, MAC 주소 등의 정보를 포함하고 있습니다. 

### 프리앰블

프리앰블은 송수신지 동기화를 위해 사용되는 8바이트(64비트) 크기의 정보로, 프리앰블의 첫 7바이트는 10101010이라는 값을 가지고, 마지막 바이트는 10101011이란 값을 가집니다. 수신지 입장에서는 이 프리앰블 비트를 통해 현재의 이더넷 프레임이 수신되고 있다는 사실을 알아차리게 됩니다. 

### 송수신지 MAC 주소

MAC 주소는 프레임에서 가장 중요한 부분이다. 프레임에는 송신지와 수신지를 특정할 수 있는 6바이트(48비트) 길이의 MAC 주소가 명시되며, 다음과 같이 콜론(:)으로 구분된 12자리 16진수로 구성되어 있습니다. 

```jsx
ab:cd:ab:cd:00:01
```

물지적 주소라고도 불리는 MAC 주소는 네트워크 인터페이스마다 하나씩 부여되는 주소입니다. 여기서 “”**네트워크 인터페이스””**란 네트워크를 향하는 통로, 연결 매체와의 연결 지점을 의미하며, 보통 NIC라는 장치가 네트워크 인터페이스를 담당합니다. 따라서 NIC가 여러 개인 상황처럼 네트워크 인터페이스가 여럿이라면 한 호스트가 여러 개의 MAC 주소를 가질 수 있습니다. 

### 타입 / 길이

MAC 주소의 타입/길이 필드에 명시된 크기가 1500 이하이면 이 필드는 프레임의 크기를 나타내고, 1536 이상이면 타입을 나타냅니다. “”타입””은 캡슐화된 상위 계층의 정보를 의미하기 때문에 타입을 통해 어떤 상위 계층 프로토콜이 캡슐화되었는지를 알 수 있습니다. 

### 데이터

데이터 필드에는 페이로드, 즉 상위 계층으로 전달하거나 전달받을 데이터가 명시됩니다. 중요한 점은 데이터 필드에 포함될 수 있는 데이터의 최대 크기가 정해져 있다는 점입니다. 

최대 크기는 일반적으로 1500바이트 이하로 제한되어 있으며, 이보다 큰 데이터를 보낼 경우에는 여러 패킷으로 나뉘어 보내집니다. 참고로, ‘1500바이트’라는 크기가 중요한 기준이 되므로 기억해 두는 것이 좋습니다. 

흔히 ‘1500바이트’는 이더넷 프레임으로 전송 가능한 최대 데이터의 크기이자, 네트워크 패킷(해더+페이로드)의 최대 크기를 지칭하는 데 사용되기 때문입니다. 이 크기를 ‘MTU’라고 부릅니다. 

### FCS

FCS는 트레일러입니다. 프레임의 오류가 있는지의 여부를 확인하기 위한 필드로, CRC라는 오류 검출용 값이 명시됩니다. 

송신지에서 전송할 데이터와 더불어 전송할 데이터에 대한 CRC 값을 계산하여 보내면 수신지에서는 전달받은 데이터에 대한 CRC 값을 계산해, 그 값을 전달받은 CRC 값과 대조합니다. 두 값이 같을 경우 프레임에 오류가 없다고 판단하는 것입니다. 

---

## 유무선 통신 매체

### 유선 매체 - 트위스티드 페어 케이블

트위스티드 페어 케이블은 구리선을 통해 전기적으로 신호를 주고받는 통신 매체로, 두 가닥(pair)씩 꼬아져 있는(twisted) 구리선 때문에 이렇게 이름이 붙었습니다. 

트위스티드 페어 케이블의 성능은 카테고리를 통해 알 수도 있습니다. 카테고리에 따라 대응되는 주요 이더넷 표준이 다르고, 표준에 따른 최대 지원 속도도 달라질 수 있습니다. 즉 카테고리는 트위스티드 페어 케이블의 성능을 구분하는 일종의 등급 역할을 합니다. 

트위스티드 페어 케이블은 구리선을 통해 전기적인 신호를 주고 받기 때문에 전기 신호에 왜곡을 줄 수 있는 주변 잡음에 취약합니다. 이러한 잡음을 ‘노이즈’라고 합니다. 그래서 트위스티드 페어 케이블을 그물 모양의 철사나 포일로 감싸 노이즈를 방지하는 경우가 많습니다. 

구리선 주변을 보호해 노이즈를 감소시키는 방식을 “”차폐””라고하며, 차폐에 사용된 그물 모양의 철사와 포일은 각각 “브레이드 실드”와 “”포일 실드””라고합니다. 
이 브레이드 실드로 노이즈를 감소시킨 케이블을 “”STP 케이블””이라고 하며, 포일 실드로 노이즈를 감소시킨 케이블을 “”FTP 케이블””이라고 합니다. 반면, 아무것도 감싸지 않아 구리선만 있는 케이블을 “”UTP 케이블””이라고 합니다. 

### 무선 매체 - 전파와 WIFI

대표적인 무선 매체는 전파가 있습니다. 전파는 약 3kHz부터 3THz 사이의 진동수를 갖는 전자기파를 의미합니다. (개발자 입장에서는 진동수 암기나 물리학적 원리 이해할 일은 없음 ) 

무선 LAN에서 가장 대중적으로 사용되는 기술은 WIFI입니다. 와이파이는 ‘IEEE 802.11’이라는 표준을 따르는 무선 LAN 기술입니다. 이더넷 표준 규격과 유사하게 숫자 뒤에 붙는 알파벳으로 각기 다른 표준 규격을 구분합니다. 

앞서 와이파에는 주로 사용되는 주파수 대역은 2.4GHz 혹은 5GHz라고 했습니다. 이 때 같은 주파수 대역을 사용하는 여러 무선 네트워크가 존재할 수 있습니다. 같은 지역 내에 2.4GHz 대역을 사용하는 무선 네트워크가 여러 개 존재하거나 5GHz 대역을 사용하는 무선 네트워크가 여러 개 존재할 수 있다는 것입니다. 

하지만 전파 통신을 주고 받을 때 주파수 대역이 겹치면 신호의 간섭이 발생할 수 있습니다. 따라서 별개의 무선 네트워크는 같은 주파수 대역을 사용하더라도 서로의 신호에 간섭하지 않아야합니다. 그래서 주파수 대역은 같은 대역을 사용하는 서로 다른 무선 네트워크를 구분하기 위해 “”채널””이라는 하위 주파수 대역으로 세분화되고, 해당 채널 대역에서 무선 통신이 이루어집니다. 

---

## 네트워크 인터페이스: NIC

네트워크 상에서 노드와 통신 매체가 연결되는 지점을 “”네트워크 인터페이스””라고 합니다. 네트워크 인터페이스는 노드와 네트워크 사이의 통로와 같습니다. 

네트워크 인터페이스마다 물리적 주소라고 불리는 MAC 주소가 부여되고, NIC라는 하드웨어가 네트워크 인터페이스의 역할을 담당하는 것이 일반적입니다. NIC는 네트워크 인터페이스 카드, 네트워크 어뎁터, LAN 카드, 네트워크 카드, 이더넷 카드 등 다양한 명칭으로 불리는 하드웨어입니다. 

통신 매체의 신호를 호스트가 이해하는 프레임으로 변환하거나 호스트가 이해하는 프레임을 통신매체의 신호로 변환하는 역할을 수행합니다. 때로는 MAC 주소를 토대로 잘못 전송된 패킷이 없는지 확인하기도 합니다. 

---

## 허브와 스위치

허브와 스위치는 물리 계층과 데이터 링크 계층의 중간 노드입니다. 허브는 오늘날 네트워크에서 자주 사용하지 않습니다. 허브 대신 스위치를 사용하는 경우가 많습니다. 

### 물리 계층의 허브

허브는 물리 계층의 대표적인 네트워크 장비로, 여러 개의 호스트를 연결하는 장치입니다. “리피터 허브”라고도 부르기도 합니다.  특히 이더넷 네트워크 허브는 “”이더넷 허브””라고 부르기도 합니다. 그리고 허브에서 케이블의 커넥터가 꽂히는 부분, 통신 매체를 연결하는 지점은 “”포트””라고합니다.

허브에는 중요한 특징 

1. 전달받은 신호를 모든 포트로 내보낸다는 점이다. 허브는 신호를 받으면 해당 신호에 대한 어떠한 조작이나 판단도 하지 않고, 모든 포트에 단순하게 신호를 보냅니다. 
2. 반이중 모드로 통신합니다. 여기서 반이중모드란 송신 또는 수신을 번갈아 가면서 수행해야 하는 통신 방식을 의미합니다. 마치 무전기와 같이 어느 한 쪽이 송신할 때 다른 쪽은 송신이 불가능합니다. 

### 데이터 링크 계층의 스위치

스위치는 허브의 한계를 보완하기 위한 네트워크 장비입니다. 스위치는 허브와 달리 전달받은 신호를 목적지 호스트가 연결된 포트로만 내보내고, 전이중 모드를 지원하므로 허브와 비교해 콜리전 도메인이 좁습니다. 

스위치가 전달받은 신호를 원하는 포트에만 내보낼 수 있는 이유는 스위치에 MAC 주소 학습 기능이 있기 때문입니다. 스위치는 데이터 링크 계층에 속한 장비이므로 MAC 주소를 이해할 수 있습니다. 

스위치는 프레임 속 MAC 주소를 토대로 현재 어떤 포트에 어떤 주소를 가진 호스트가 연결되어 있는지 파악하고, ‘포트, 연결된 호스트의 MAC 주소’의 대응 관계를 테이블의 형태로 메모리에 저장합니다. 이 정보를 “”MAC 주소 테이블””이라고 합니다. 

MAC 주소 학습 기능 외에 스위치의 또 다른 대표 기능은 VLAN입니다. VLAN은 가상의 LAN을 의미합니다. 이 기능은 대표적으로 같은 스위치에 연결된 모든 호스트를 하나의 네트워크로 간주하고 싶지 않을 때, 여러 논리적인 네트워크로 나누고 싶을 때 사용합니다.