# 트리

트리는 주로 계층적인 구조로 표현하기 위한 자료구조입니다. 데이터가 저장되어 있는 **““노드””,** 노드와 노드를 연결하는 **““간선(링크)””**으로 이루어져 있으며, 간선으로 연결된 노드는 상하 관계를 형성합니다. 

이웃한 노드 간에 형성된 상하 관계에서 상위에 위치한 노드는 **“”부모 노드””**라고 하고, 하위에 위치한 노드는 **“”자식 노드””**라고 합니다. 노드는 하나 이상의 자식 노드를 가질 수 있지만, 부모 노드는 하나만 있을 수 있습니다.

같은 부모를 공유하는 노드는 **“”형제 노드””**라고 하고, 부모 노드와 그 부모 노드들은 **“”조상 노드””,** 자식 노드와 그 자식 노드들은 **“”지손 노드””**라고 통칭합니다. 

트리는 주로 계층적 자료구조를 표현하므로 최상단 노드와 최하단 노드가 있습니다. 부모 노드가 없는 최상단 노드는 **“”루트 노드””**는 트리의 노드 중 유일하게 부모 노드가 없는 노드입니다. 뻗어 나가는 나무의 끝에 잎(leaf)이 달려 있듯, 뻗어 나가는 트리의 최하단 끝에는 **“”리프 노드””**가 있습니다. 리프 노드는 더 이상의 자식 노드가 없는 최하단 노드를 말합니다. 

### 차수, 레벨, 서브트리

- 차수: 차수란 각 노드가 가지는 자식 노드의 수를 말합니다.
- 레벨: 레벨은 루트 노드에서 시작해 특정 노드에 이르기까지 거치게 되는 간선의 수를 의미합니다. 쉽게 말해, 특정 노드가 얼마나 깊은 곳에 있는지를 뜻하는 트리의 깊이와 같은 개념입니다.
- 서브트리: 트리 안에 포함되어 있는 트리를 서브트리라고 합니다. 서브트리도 트리이기 때문에 루트 노드를 가질 수 있습니다.

이처럼 다양한 모양을 가진 트리 자료구조는 어떻게 구현되고, 어떻게 메모리 상에 저장될까요? 구현 방식은 다양할 수 있지만, 마치 연결 리스트처럼 하나의 노드를 ‘데이터를 저장할 공간’과 ‘자식 노드의 위치 정보(메모리 상의 주소)를 저장할 공간(들)’의 모음으로 간주함으로써 구현할 수 있습니다. 

## 트리의 순회

트리의 모든 노드를 한 번씩 방문하는 것을 트리의 순회라고 부릅니다. 트리의 모든 노드를 한 번씩 방문하는 순회는 3가지 대표적인 방법이 있습니다. 

### 전위 순위

전위 순위는 루트 노드부터 시작해 왼쪽 서브트리를 전위 순회하고, 이후 오른쪽 서브트리를 전위 순회하는 순회 방식입니다. 

1. 루트 노드
2. 왼쪽 서브트리
3. 오른쪽 서브트리

### 중위 순회

중위 순회는 루트 노드 기준 왼쪽 서브트리를 중위 순회한 다음, 루트 노드를 방문하고 오른쪽 서브트리를 중위 순회하는 순서로 노드에 접근하는 순회 방법입니다. 

1. 왼쪽 서브트리
2. 루트 노드
3. 오른쪽 서브트리

### 후위 순회

후위 순회는 루트 노드 기준 왼쪽 서브트리를 후위 순회하고, 오른쪽 서브트리까지 후위 순회한 다음, 루트 노드를 방문하는 순서로 노드에 접근하는 순회 방법입니다. 

1. 왼쪽 서브트리
2. 오른쪽 서브트리
3. 루트 노드

# 트리의 종류

### 이진 트리

이진 트리는 자식 노드의 개수가 2개 이하인 트리를 말합니다. 이진 트리는 일반적으로 ‘트리’라고 했을 때 가장 먼저 떠올릴만한, 가장 대중적인 트리 중 하나입니다. 

### 편향된 이진 트리

모든 자식 노드가 한 쪽으로 치우친 이진 트리는 편향된 이진 트리라고 부릅니다. 

## 정 이진트리, 포화 이진 트리, 완전 이진 트리

### 정 이진트리

정 이진 트리는 자식 노드의 개수가 1개가 아닌 이진 트리를 말합니다. 다시 말해, 자식 노드의 개수가 0개 또는 2개인 이진 트리를 정 이진 트리라고 부릅니다. 

### 포화 이진 트리

포화 이진 트리는 리프 노드를 제외한 모든 노드들이 자식 노드를 2개씩 가지고 있고, 모든 리프 노드의 레벨이 동일한 이진 트리를 말합니다. 

### 완전 이진 트리

완전 이진 트리는 ***마지막 레벨을 제외한 모든 레벨이 2개의 자식 노드를 가지고 있으며***, 마지막 레벨의 모든 노드들이 ***왼쪽부터 존재하는*** 이진 트리를 말합니다. 

## 탐색에 활용되는 트리: 이진 탐색 트리와 힙

### 이진 탐색 트리

이진 탐색 트리란 특정 노드의 왼쪽 서브트리에는 해당 노드보다 작은 값을 지닌 노드들이 있고, 오른쪽 서브트리에는 해당 노드보다 큰 값을 지닌 노드들이 있는 구조의 이진 트리를 의미합니다. 쉽게 말해, 특정 노드의 왼쪽에는 해당 노드보다 작은 값이, 오른쪽에는 해당 노드보다 큰 값이 있는 트리가 이진 탐색 트리입니다. 

### 힙

완전 이진 트리의 종류 중 하나인 힙은 주로 최댓값과 최솟값을 빠르게 찾기 위해 사용됩니다.  힙에는 크게 두 종류가 있습니다. 최대 힙과 최소 힙입니다. 최대 힙은 부모 노드가 자식 노드의 값보다 큰 값으로 이루어진 이진 트리, 최소 힙은 부모 노드가 자식 노드의 값보다 작은 값으로 이루어진 트리를 말합니다. 

참고로, 노드 간 크기(크다/작다)의 비교는 숫자만 가능한 것이 아닙니다. 문자 간의 비교도 가능하고, 때로는 원하는 우선순위를 작접 지정할 수 있습니다. 

## 균형을 맞추는 트리: RB 트리

이진 탐색 트리는 한 가지 문제가 있습니다. 삽입과 삭제를 반복하는 과정에서 다음 그림과 같이 트리가 한 쪽에만 자라나는 편향된 트리가 될 수 있다는 것입니다. 같은 노드의 집합으로 구성된 트리라도 연산의 순서에 따라 편향된 트리가 될 수 있습니다. 이 경우에는 편향 트리의 탐색 속도가 O(n)으로 연결 리스트와 다를 바 없게 되고, 사실상 트리 자료구조를 사용할 이유가 없어지게 됩니다. 

이진 탐색 트리의 탐색 성능을 언제나 균일하게 유지하려면 루트 노드 기준 왼쪽 서브트리와 오른쪽 서브트리의 높이 차이가 최소화되어야 합니다. 왼쪽 서브트리와 오른쪽 서브트리 높이의 균형을 맞추는 특별한 이진 탐색 트리가 있습니다. “”자가 균형 이진 탐색 트리””라는 이름의 트리로, AVL 트리와 RB 트리가 대표적입니다. 

RB 트리는 노드에 색을 칠하는 규칙과 노드에 칠해진 색을 기준으로 왼쪽 서브트리 높이와 오른쪽 서브트리 높이의 균형을 맞춥니다. 노드에 색상을 칠하는 규칙은 RB 트리가 유지되는 조건과 같습니다. 

1. 루트 노드는 블랙 노드이다.
2. 리프 노드는 블랙 노드이다. 
3. 레드 노드의 자식 노드는 블랙 노드이다. 
4. 어떤 노드에서 임의의 리프 노드에 이르는 경로의 블랙 노드 수는 같다. 

RB 트리의 리프 노드는 실질적인 데이터가 저장되어 있지 않은 노드로 가정합니다. 흔히 NIL노드라고 부릅니다. 

## 대용량 입출력을 위한 트리: B 트리

B 트리는 RB트리와 마찬가지로 균형을 유지하는 트리 중 하나입니다. 차이가 있다면 B트리는 이진 탐색 트리가 아닌 다진 탐색 트리의 한 종류라는 것입니다. 다진 탐색 트리는 한 노드가 여러 자식 노드를 가질 수 있는 트리입니다. 

여러 자식 노드를 가질 수 있는 다진 탐색 트리인 B 트에서 한 노드가 가질 수 있는 자식 노드의 수는 최소, 최대 개수가 정해져 있습니다. 한 노드가 가질 수 있는 **최대 자식 노드의 개수가 M개**인 B 트리는 **M차 B 트리**라고 부릅니다. M차 B 트리가 가질 수 있는 최소 노드의 개수는 M/2(올림)개 입니다. 예를 들어 5차 B트리의 한 노드가 최대 5개의 자식 노드를 가질수 있고, 노드들은 최소 3개의 자식 노드를 가질 수 있습니다.

이진 탐색 트리는 왼쪽 자식 노드의 크기가 오른쪽 자식 노드의 크기보다 작았습니다. B 트리에서는 이와 유사하게 각 키 사이에 자식 노드의 위치를 저장하며, 키가 자식 노드가 가질 수 없는 값의 범위를 나타내는 역할을 합니다. 키 사이사이에 자식 노드가 존재하기 때문에 **키가 N개인 노드가 가질 수 있는 자식노드의 수는 반드시 (N+1)개**가 됩니다. 또한 B 트리는 모든 리프 노드와 깊이가 같다는 특징도 가지고 있습니다. 따라서 특정 노드에만 자식 노드가 존재하는 편향된 형태는 발생하지 않습니다. 

B 트리는 파일 시스템, 데이터베이스와 같이 대량의 데이터를 기반으로 탐색, 접근, 저장을 수행할 때 저장됩니다. 파일 시스템, 데이터베이스와 같은 프로그램을 실행할 때에는 입출력 연산 횟수를 최소화하는 것이 좋습니다. 앞에서 학습했듯 입출력 연산은 일반적으로 메모리 접근에 비해 수행 속도가 느리기 때문이죠.