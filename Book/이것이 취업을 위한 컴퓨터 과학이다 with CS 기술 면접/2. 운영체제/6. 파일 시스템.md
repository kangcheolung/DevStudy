# 파일 시스템

파일시스템이란 보조기억장치의 정보를 파일 및 디렉터리의 형태로 저장하고 관리할 수 있도록 하는 운영체제 내부 프로그램이다. 파일 시스템 덕분에 보조기억장치에 있는 수많은 정보의 덩아리를 파일과 디렉터리의 형태로 저장하고 관리할 수 있다. 

## 파일

파일은 크게 파일의 이름, 파일을 실행하기 위한 정보, 파일과 관련된 부가 정보로 구성되어 있다. 여기서 파일과 관련된 부가 정보를 속성 또는 메타데이터라고 부른다. 

가량 프로세스가 시스템 콜을 통해 읽고 쓸 수 있는 10개의 파일을 할당받았다면 프로세스는 할당을 받아 사용중인 파일을 구분할 수 있어야 한다. 이를 위해 프로세스는 “파일 디스크립터”라는 정보를 사용한다. 파일 디스크립터는 저수준에서 파일을 식별하는 정보로, 0이상의 정수 형태를 띄고 있다. 운영체제는 프로세스가 새로 파일을 열거나 생성할 때 파일에 대한 파일 디스크립터를 프로세스에 할당한다. 

### 디렉터리

운영체제는 여러 파일들을 일목요연하게 관리가힉 위해 디렉터리를 이용한다. 윈도우 운영체제에서는 디렉터리를 폴터라고 부른다. 오늘날의 디렉터리는 여러 계층을 가진 **“트리 구조 디렉터리”**로 관리된다고 할 수 있다. 

트리 구조 디렉터리는 최상위 디렉터리와 그 최상위 디렉터리가 포함되고 있는 서브 디렉터리가 있을 수 있다. 서브 디렉터리도 또 다른 서브 디렉터리를 포함 할 수 있다. **“루트 디렉터리”라고 불리는 최상위 디렉타리는 흔히 슬래시(/)로 표현하며, 슬래시(/)는 디렉터리를 구분하는 구분자로도 사용된다.** 

디렉터리 정보를 활용해 파일 위치를 특정하는 정보를 **“경로”**라고 한다. 

운영체제에서는 디렉터리를 조금 특별한 “파일”로 간주한다. 디렉터리에 요소의 관련 정보는 테이블(표)의 형태로 표현되며, 테이블 형태로 표현된 정보의 행 하나하나를 **“디렉터리 엔트리**”라고 한다. 

디렉터리 엔트리에는 ‘파일의 이름’과 ‘파일이 저장된 위치를 유추할 수 있는 정보’가 반드시 포함되어 있다. 디렉터리 엔트리를 통해 보조기억장치에 저장되어 있는 위치를 알 수 있기 때문에 디렉터리에 속한 파일의 위치를 읽어 실행 할 수도 있고, 디렉터리에 속한 다른 디렉터리의 위치를 찾아 이동할 수도 있다. 

### 파일 할당

운영체제는 파일과 디렉터리를 “블록”이라는 단위로 읽고 쓴다. 즉, 하나의 파일을 보조기억장치에 저장될 때는 하나 이상의 블록이라는 단위로 읽고 쓴다. 

어떤 파일 시스템은 각 블록의 일부에 다음 블록의 주소를 저장하여 각각의 블록이 다음 블록을 가리키는 형태로 할당할 수 있다. 이를 **“연결 할당”**이라고 한다. 일반적으로 디렉터리 엔트리에는 파일 이름과 더불어, 파일을 이루는 첫 번째 블록 주소와 파일을 이루는 블록 단위의 길이가 명시된다. 

어떤 파일 시스템에서는 파일을 이루는 모든 블록의 주소를 **“색인 블록”**이라는 특별한 블록에 모아 관리하는 방식으로 할당할 수 있다. 이를 **“색인 할당”**이라고 한다. 색인 할당을 사용하는 파일 시스템에서는 디렉터리 엔트리에 파일 이름과 함께 색인 블록 주소가 명시된다. 

## 파일 시스템

파일 시스템의 종류는 다양하다. 운영체제마다 각기 다른 파일 시스템을 지원하며, 같은 운영체제라도 다른 파일 시스템을 사용하거나 하나의 컴퓨터에서 여러 파일 시스템을 사용할 수 있다. 

다양한 파일 시스템 중 어떤 파일 시스템을 사용할지는 보조기억장치를 포매팅할 때 결정할 수 있다. **“포매팅”**이란 파일 시스템을 설정하여 어떤 방식으로 파일을 저장하고 관리할 것인지를 결정하고, 새로운 데이터를 쓸 준비를 하는 작업을 의미한다. 

### 아이노드 기반 파일 시스템

아이노드 기반 파일 시스템에서는 파일마다 각각의 아이노드를 가지고 있으며, 아이노드에는 각각의 번호가 부여되어 있다. 

실제 아이노드 기반 파일 시스템의 구성을 살펴보자. 다음은 대표적인 아이노드 기반 파일 시스템인 EXT4 파일 시스템이다. EXT4라는 파일 시스템으로 포메팅된 파티션은 다음과 같이 구성된다고 이해하면 된다. 

EXT4는 여러 블록 그룹으로 이루어져 있는데 데아터가 저장되는 영역은 아니고, 부팅과 파티션 관리를 위한 특별한 정보가 모여 있는 영역이다. 각 블록 그룹은 대략 슈퍼 블록, 그룹자 식별, 블록 비트맵, 아이노드 비트맵, 아이노드 테이블, 데이터 블록으로 구성된다. 

### 마운트

USB 메모리 저장장치를 예로 들어 생각해 보겠다. USB 메모리를 데스크탑 컴퓨터에 연결하면 데스크톱 컴퓨터의 파일 시스템을 통해 USB 메모리의 파일 시스템에 접근할 수 있다. 이것이 가능한 이유는 USB 메모리의 파일 시스템이 데스크톱 컴퓨터의 파일 시스템에 마운트되었기 때문이다.  즉, **“마운트”**는 어떤 저장장치의 파일 시스템에서 다른 저장장치의 파일 시스템으로 접근할 수 있도록 파일 시스템을 편입시키는 작업을 의미한다.